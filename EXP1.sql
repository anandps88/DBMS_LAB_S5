-- CREATING TABLES

-- PRODUCT TABLE
CREATE TABLE PRODUCT (product_no VARCHAR(15) NOT NULL,description VARCHAR(20) NOT NULL,company VARCHAR(15) NOT NULL,price INT NOT NULL,PRIMARY KEY (product_no));

-- CUSTOMER TABLE
CREATE TABLE CUSTOMER (cust_no VARCHAR(15) NOT NULL,name VARCHAR(30) NOT NULL,age INT NOT NULL,city VARCHAR(30) NOT NULL,pincode INT NOT NULL,state VARCHAR(15) NOT NULL,PRIMARY KEY (cust_no));

-- SUPPLIER TABLE
CREATE TABLE SUPPLIER (s_no VARCHAR(10) NOT NULL,sname VARCHAR(30) NOT NULL,city VARCHAR(15) NOT NULL,PRIMARY KEY (s_no));

-- PURCHASE TABLE
CREATE TABLE PURCHASE (order_no VARCHAR(15) NOT NULL,custno VARCHAR(15) NOT NULL,prono VARCHAR(15) NOT NULL,quantity INT NOT NULL,orderdate DATE,PRIMARY KEY (order_no),FOREIGN KEY (custno) REFERENCES CUSTOMER(cust_no),FOREIGN KEY (prono) REFERENCES PRODUCT(product_no));


--INSERTING VALUES

--PRODUCT TABLE
INSERT INTO PRODUCT VALUES ('P00001', '12 W Flood Light', 'Wipro', 5000);
INSERT INTO PRODUCT VALUES('P00002', 'Laptop Adapter', 'Dell', 1560);
INSERT INTO PRODUCT VALUES('P00003', 'Tablet', 'HCL', 11000);
INSERT INTO PRODUCT VALUES('P00004', 'Garnet 50W led', 'Wipro', 999);
INSERT INTO PRODUCT VALUES('P00005', 'Laptop Charger', 'HCL', 1690);

-- CUSTOMER TABLE
INSERT INTO CUSTOMER VALUES ('C00001', 'Ivan Bayross', 35, 'Bombay', 400054, 'Maharashtra');
INSERT INTO CUSTOMER VALUES('C00002', 'Vandana Saitwal', 35, 'Madras', 780001, 'Tamilnadu');
INSERT INTO CUSTOMER VALUES('C00003', 'Pramada Jaguste', 55, 'Bombay', 400057, 'Maharashtra');
INSERT INTO CUSTOMER VALUES('C00004', 'Basu Navindgi', 45, 'Bombay', 400056, 'Maharashtra');
INSERT INTO CUSTOMER VALUES('C00005', 'Ravi Sreedharan', 25, 'Delhi', 100001, 'Delhi');
INSERT INTO CUSTOMER VALUES('C00006', 'Rukmini', 25, 'Madras', 780001, 'Tamilnadu');


-- SUPPLIER TABLE
INSERT INTO SUPPLIER VALUES ('S001', 'Ivan Bayross', 'Bombay');
INSERT INTO SUPPLIER VALUES('S002', 'Nirmala Agarwal', 'Madras');
INSERT INTO SUPPLIER VALUES('C003', 'Susmitha', 'Bombay');
INSERT INTO SUPPLIER VALUES('C004', 'Basu Navindgi', 'Bombay');    
INSERT INTO SUPPLIER VALUES('C005', 'Ravi Sreedharan', 'Delhi');
INSERT INTO SUPPLIER VALUES('C006', 'Nanda Gopal', 'Madras'); 

-- PURCHASE TABLE
INSERT INTO PURCHASE VALUES ('O00001', 'C00002', 'P00003', 2, '20-JAN-16');
INSERT INTO PURCHASE VALUES('O00002', 'C00003', 'P00002', 1, '27-JAN-16');
INSERT INTO PURCHASE VALUES('O00003', 'C00006', 'P00001', 3, '20-FEB-16');
INSERT INTO PURCHASE VALUES('O00004', 'C00003', 'P00005', 4, '07-APR-16');
INSERT INTO PURCHASE VALUES('O00005', 'C00004', 'P00002', 2, '22-MAY-16');
INSERT INTO PURCHASE VALUES('O00006', 'C00005', 'P00004', 1, '26-MAY-16');


-- _______________________________
-- QUERIES
-- _______________________________

-- 1. CUSTOMERS IN MADRAS
SELECT NAME FROM CUSTOMER WHERE CITY='Madras';

NAME
------------------------------
Vandana Saitwal
Rukmini

-- 2. CUSTOMERS IN JANUARY
SELECT CUSTNO FROM PURCHASE WHERE ORDERDATE LIKE '%-JAN-%';

CUSTNO
---------------
C00002
C00003

-- 3. COMPANY PRICE 
SELECT COMPANY FROM PRODUCT WHERE PRICE > 5000;

COMPANY
---------------
HCL

-- 4. CUSTOMER NAME NOT BEGINNING WITH R
SELECT NAME FROM CUSTOMER WHERE NAME NOT LIKE 'R%';

NAME
------------------------------
Ivan Bayross
Vandana Saitwal
Pramada Jaguste
Basu Navindgi

-- 5. EMAIL FIELD TO CUSTOMER TABLE
ALTER TABLE CUSTOMER ADD (EMAIL_ID VARCHAR(20));

Table altered.

-- 6. CUSTOMER AGE > 40
SELECT NAME FROM CUSTOMER WHERE AGE>40;

NAME
------------------------------
Pramada Jaguste
Basu Navindgi

-- 7. COMPANY NAMES IN INCREASING ORDER OF PRICE
SELECT COMPANY FROM PRODUCT ORDER BY PRICE;

COMPANY
---------------
Wipro
Dell
HCL
Wipro
HCL

-- 8. AVERAGE AGE OF CUSTOMERS
SELECT AVG(AGE) FROM CUSTOMER;

  AVG(AGE)
----------
36.6666667

-- 9. CITIES OF CUSTOMERS OF MAHARASHTRA AND TAMILNADU
SELECT CITY FROM CUSTOMER WHERE STATE = 'Maharashtra' OR STATE = 'Tamilnadu';

CITY
------------------------------
Bombay
Madras
Bombay
Bombay
Madras

-- 10. AVERAGE PRICE FROM PRODUCT TABLE
SELECT AVG(PRICE) FROM PRODUCT;

AVG(PRICE)
----------
    4049.8

-- 11. CUSTOMER NUMBER IN INCREASING ORDER FROM PURCHASE
SELECT CUSTNO FROM PURCHASE ORDER BY CUSTNO;

CUSTNO
---------------
C00002
C00003
C00003
C00004
C00005
C00006

6 rows selected.

-- 12. UPDATE PRODUCT NUMBER TO P00008 FRO CUSTOMER C00003
INSERT INTO PRODUCT VALUES('P00008','Mouse','Artic Fox','700');

1 row created.

UPDATE PURCHASE SET PRONO = 'P00008' WHERE CUSTNO = 'C00003';

2 rows updated.

-- 13. NUMBER OF CUSTOMERS FROM DELHI
SELECT COUNT(CITY) FROM CUSTOMER WHERE CITY='Delhi';

COUNT(CITY)
-----------
          1

-- 14. CUSTOMER PURCHASED MORE THAN 3 ITEMS
SELECT CUSTNO FROM PURCHASE WHERE QUANTITY>3;

CUSTNO
---------------
C00003

-- 15. MODIFY STRUCTURE OF DATE FIELD TO CHARACTERS
UPDATE PURCHASE SET ORDERDATE = NULL;

6 rows updated.

ALTER TABLE PURCHASE MODIFY ORDERDATE VARCHAR(10);

Table altered.

-- 16. MINIMUM AND MAXIMUM PRICE FROM PRODUCT TABLE
SELECT MIN(PRICE),MAX(PRICE) FROM PRODUCT;

MIN(PRICE) MAX(PRICE)
---------- ----------
       700      11000

-- 17. NUMBER OF PRODUCTS BY WIPRO AND HCL SEPERATE
SELECT COMPANY,COUNT(*) FROM PRODUCT WHERE COMPANY = 'Wipro' OR COMPANY ='HCL' GROUP BY COMPANY;

COMPANY           COUNT(*)
--------------- ----------
Wipro                    2
HCL                      2

-- 18. CUSTOMERS IN ALPHABET ORDER
SELECT NAME FROM CUSTOMER ORDER BY NAME;

NAME
------------------------------
Basu Navindgi
Ivan Bayross
Pramada Jaguste
Ravi Sreedharan
Rukmini
Vandana Saitwal

6 rows selected.

-- 19. SORT CONTENTS OF PURCHASE TABLE IN DESCENDING ORDER OF DATE
ALTER TABLE PURCHASE MODIFY ORDERDATE DATE;

Table altered.

UPDATE PURCHASE SET ORDERDATE = '20-JAN-16' WHERE ORDER_NO = 'O00001';

1 row updated.

UPDATE PURCHASE SET ORDERDATE = '27-JAN-16' WHERE ORDER_NO = 'O00002';

1 row updated.

UPDATE PURCHASE SET ORDERDATE = '20-FEB-16' WHERE ORDER_NO = 'O00003';

1 row updated.

UPDATE PURCHASE SET ORDERDATE = '07-APR-16' WHERE ORDER_NO = 'O00004';

1 row updated.

UPDATE PURCHASE SET ORDERDATE = '22-MAY-16' WHERE ORDER_NO = 'O00005';

1 row updated.

UPDATE PURCHASE SET ORDERDATE = '26-MAY-16' WHERE ORDER_NO = 'O00006';

1 row updated.

SELECT * FROM PURCHASE ORDER BY ORDERDATE DESC;

ORDER_NO        CUSTNO          PRONO             QUANTITY ORDERDATE
--------------- --------------- --------------- ---------- ------------------
O00006          C00005          P00004                   1 26-MAY-16
O00005          C00004          P00002                   2 22-MAY-16
O00004          C00003          P00008                   4 07-APR-16
O00003          C00006          P00001                   3 20-FEB-16
O00002          C00003          P00008                   1 27-JAN-16
O00001          C00002          P00003                   2 20-JAN-16

6 rows selected.

-- 20. DELETE PRODUCT  WITH PRODUCT_NO P00003
ALTER TABLE PURCHASE MODIFY PRONO VARCHAR(15) NULL;

Table altered.

DELETE FROM PRODUCT WHERE PRODUCT_NO='P00003';

